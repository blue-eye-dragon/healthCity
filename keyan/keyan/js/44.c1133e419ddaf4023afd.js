webpackJsonp([44],{TOp4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),i=a("exGp"),o=a.n(i),l=a("Dd8w"),u=a.n(l),s=a("7iNX"),d=a("NYxO"),c=a("eIA8"),h=a("6sVf"),p=Object({NODE_ENV:"production"}).VUE_APP_BASE_API,m={name:"Api",components:{CustomPic:c.default,ChooseImg:h.default},mixins:[s.default],data:function(){return{path:p,authOptions:[],addUserDialog:!1,userInfo:{username:"",password:"",nickName:"",headerImg:"",authorityId:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,message:"最低5位字符",trigger:"blur"}],password:[{required:!0,message:"请输入用户密码",trigger:"blur"},{min:6,message:"最低6位字符",trigger:"blur"}],nickName:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],authorityId:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}}},computed:u()({},Object(d.c)("user",["token"])),created:function(){var e=this;return o()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.tableData=[{ID:1,CreatedAt:"2021-06-30T11:07:10+08:00",UpdatedAt:"2021-06-30T11:08:03+08:00",uuid:"712a010c-ab54-4768-bdb8-1105f75776b9",userName:"admin",nickName:"超级管理员",headerImg:"http://qmplusimg.henrongyi.top/gva_header.jpg",authority:{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-07-13T11:50:19+08:00",DeletedAt:null,authorityId:"888",authorityName:"普通用户",parentId:"0",dataAuthorityId:null,children:null,menus:null,defaultRouter:"person"},authorityId:"888",sideMode:"dark",activeColor:"#1890ff",baseColor:"#fff"},{ID:2,CreatedAt:"2021-06-30T11:07:10+08:00",UpdatedAt:"2021-06-30T11:07:10+08:00",uuid:"6158253d-d38e-4e19-b5f4-11ecce918698",userName:"a303176530",nickName:"QMPlusUser",headerImg:"http://qmplusimg.henrongyi.top/1572075907logo.png",authority:{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"9528",authorityName:"测试角色",parentId:"0",dataAuthorityId:null,children:null,menus:null,defaultRouter:"dashboard"},authorityId:"9528",sideMode:"dark",activeColor:"#1890ff",baseColor:"#fff"}],e.setOptions([{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"888",authorityName:"普通用户",parentId:"0",dataAuthorityId:[{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"888",authorityName:"普通用户",parentId:"0",dataAuthorityId:null,children:null,menus:null,defaultRouter:"dashboard"},{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"8881",authorityName:"普通用户子角色",parentId:"888",dataAuthorityId:null,children:null,menus:null,defaultRouter:"dashboard"},{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"9528",authorityName:"测试角色",parentId:"0",dataAuthorityId:null,children:null,menus:null,defaultRouter:"dashboard"}],children:[{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"8881",authorityName:"普通用户子角色",parentId:"888",dataAuthorityId:[],children:[],menus:null,defaultRouter:"dashboard"}],menus:null,defaultRouter:"dashboard"},{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"9528",authorityName:"测试角色",parentId:"0",dataAuthorityId:[{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"8881",authorityName:"普通用户子角色",parentId:"888",dataAuthorityId:null,children:null,menus:null,defaultRouter:"dashboard"},{CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",DeletedAt:null,authorityId:"9528",authorityName:"测试角色",parentId:"0",dataAuthorityId:null,children:null,menus:null,defaultRouter:"dashboard"}],children:[],menus:null,defaultRouter:"dashboard"}]);case 2:case"end":return t.stop()}},t,e)}))()},methods:{openHeaderChange:function(){this.$refs.chooseImg.open()},setOptions:function(e){this.authOptions=[],this.setAuthorityOptions(e,this.authOptions)},setAuthorityOptions:function(e,t){var a=this;e&&e.map(function(e){if(e.children&&e.children.length){var r={authorityId:e.authorityId,authorityName:e.authorityName,children:[]};a.setAuthorityOptions(e.children,r.children),t.push(r)}else{var n={authorityId:e.authorityId,authorityName:e.authorityName};t.push(n)}})},deleteUser:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return o()(n.a.mark(function a(){return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,deleteUser({id:e.ID});case 2:0===a.sent.code&&(t.getTableData(),e.visible=!1);case 4:case"end":return a.stop()}},a,t)}))()}),enterAddUserDialog:function(){var e=this;return o()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$refs.userForm.validate(function(){var t=o()(n.a.mark(function t(a){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}return t.next=3,register(e.userInfo);case 3:return 0===t.sent.code&&e.$message({type:"success",message:"创建成功"}),t.next=7,e.getTableData();case 7:e.closeAddUserDialog();case 8:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,e)}))()},closeAddUserDialog:function(){this.$refs.userForm.resetFields(),this.addUserDialog=!1},handleAvatarSuccess:function(e){this.userInfo.headerImg=e.data.file.url},addUser:function(){this.addUserDialog=!0},changeAuthority:function(e){var t=this;return o()(n.a.mark(function a(){return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,setUserAuthority({uuid:e.uuid,authorityId:e.authority.authorityId});case 2:0===a.sent.code&&t.$message({type:"success",message:"角色设置成功"});case 4:case"end":return a.stop()}},a,t)}))()}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"button-box clearflex"},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:e.addUser}},[e._v("新增用户")])],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"头像","min-width":"50"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("div",{style:{textAlign:"center"}},[a("CustomPic",{attrs:{"pic-src":e.row.headerImg}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"uuid","min-width":"250",prop:"uuid"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名","min-width":"150",prop:"userName"}}),e._v(" "),a("el-table-column",{attrs:{label:"昵称","min-width":"150",prop:"nickName"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户角色","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-cascader",{attrs:{options:e.authOptions,"show-all-levels":!1,props:{checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},filterable:""},on:{change:function(a){return e.changeAuthority(t.row)}},model:{value:t.row.authority.authorityId,callback:function(a){e.$set(t.row.authority,"authorityId",a)},expression:"scope.row.authority.authorityId"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.row.visible,callback:function(a){e.$set(t.row,"visible",a)},expression:"scope.row.visible"}},[a("p",[e._v("确定要删除此用户吗")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.deleteUser(t.row)}}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",size:"mini"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),e._v(" "),a("el-pagination",{style:{float:"right",padding:"20px"},attrs:{"current-page":e.page,"page-size":e.pageSize,"page-sizes":[10,30,50,100],total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),e._v(" "),a("el-dialog",{attrs:{visible:e.addUserDialog,"custom-class":"user-dialog",title:"新增用户"},on:{"update:visible":function(t){e.addUserDialog=t}}},[a("el-form",{ref:"userForm",attrs:{rules:e.rules,model:e.userInfo}},[a("el-form-item",{attrs:{label:"用户名","label-width":"80px",prop:"username"}},[a("el-input",{model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码","label-width":"80px",prop:"password"}},[a("el-input",{model:{value:e.userInfo.password,callback:function(t){e.$set(e.userInfo,"password",t)},expression:"userInfo.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"别名","label-width":"80px",prop:"nickName"}},[a("el-input",{model:{value:e.userInfo.nickName,callback:function(t){e.$set(e.userInfo,"nickName",t)},expression:"userInfo.nickName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"头像","label-width":"80px"}},[a("div",{staticStyle:{display:"inline-block"},on:{click:e.openHeaderChange}},[e.userInfo.headerImg?a("img",{staticClass:"header-img-box",attrs:{src:e.userInfo.headerImg}}):a("div",{staticClass:"header-img-box"},[e._v("从媒体库选择")])])]),e._v(" "),a("el-form-item",{attrs:{label:"用户角色","label-width":"80px",prop:"authorityId"}},[a("el-cascader",{attrs:{options:e.authOptions,"show-all-levels":!1,props:{checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},filterable:""},model:{value:e.userInfo.authorityId,callback:function(t){e.$set(e.userInfo,"authorityId",t)},expression:"userInfo.authorityId"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeAddUserDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.enterAddUserDialog}},[e._v("确 定")])],1)],1),e._v(" "),a("ChooseImg",{ref:"chooseImg",attrs:{target:e.userInfo,"target-key":"headerImg"}})],1)},staticRenderFns:[]};var y=a("VU/8")(m,f,!1,function(e){a("gljj")},null,null);t.default=y.exports},gljj:function(e,t){}});
//# sourceMappingURL=44.c1133e419ddaf4023afd.js.map