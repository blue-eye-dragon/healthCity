webpackJsonp([46],{MpzO:function(e,t){},XIif:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Xxa5"),r=a.n(i),o=a("exGp"),n=a.n(o),l=[{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}],s={name:"Api",filters:{methodFiletr:function(e){var t=l.filter(function(t){return t.value===e})[0];return t&&""+t.label},tagTypeFiletr:function(e){var t=l.filter(function(t){return t.value===e})[0];return t&&""+t.type}},mixins:[a("7iNX").default],data:function(){return{deleteVisible:!1,dialogFormVisible:!1,dialogTitle:"新增Api",page:1,total:10,pageSize:72,tableData:[{ID:3,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/api/createApi",description:"创建api",apiGroup:"api",method:"POST"},{ID:4,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/api/getApiList",description:"获取api列表",apiGroup:"api",method:"POST"},{ID:5,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/api/getApiById",description:"获取api详细信息",apiGroup:"api",method:"POST"},{ID:6,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/api/deleteApi",description:"删除Api",apiGroup:"api",method:"POST"},{ID:7,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/api/updateApi",description:"更新Api",apiGroup:"api",method:"POST"},{ID:8,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/api/getAllApis",description:"获取所有api",apiGroup:"api",method:"POST"},{ID:85,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/api/deleteApisByIds",description:"批量删除api",apiGroup:"api",method:"DELETE"},{ID:9,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/authority/createAuthority",description:"创建角色",apiGroup:"authority",method:"POST"},{ID:10,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/authority/deleteAuthority",description:"删除角色",apiGroup:"authority",method:"POST"},{ID:11,CreatedAt:"2021-06-15T15:06:25+08:00",UpdatedAt:"2021-06-15T15:06:25+08:00",path:"/authority/getAuthorityList",description:"获取角色列表",apiGroup:"authority",method:"POST"}],apis:[],form:{path:"",apiGroup:"",method:"",description:""},methodOptions:l,type:"",rules:{path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}}},created:function(){this.getTableData()},methods:{handleSelectionChange:function(e){this.apis=e},onDelete:function(){var e=this;return n()(r.a.mark(function t(){var a,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.apis.map(function(e){return e.ID}),t.next=3,deleteApisByIds({ids:a});case 3:0===(i=t.sent).code&&(e.$message({type:"success",message:i.msg}),e.tableData.length===a.length&&e.page>1&&e.page--,e.deleteVisible=!1,e.getTableData());case 5:case"end":return t.stop()}},t,e)}))()},sortChange:function(e){var t=e.prop,a=e.order;t&&(this.searchInfo.orderKey=toSQLLine(t),this.searchInfo.desc="descending"===a),this.getTableData()},onSubmit:function(){this.page=1,this.pageSize=10,this.getTableData()},initForm:function(){this.$refs.apiForm.resetFields(),this.form={path:"",apiGroup:"",method:"",description:""}},closeDialog:function(){this.initForm(),this.dialogFormVisible=!1},openDialog:function(e){switch(e){case"addApi":this.dialogTitle="新增Api";break;case"edit":this.dialogTitle="编辑Api"}this.type=e,this.dialogFormVisible=!0},editApi:function(e){var t=this;return n()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.form=e,t.openDialog("edit");case 2:case"end":return a.stop()}},a,t)}))()},deleteApi:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return n()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.$confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,deleteApi(e);case 2:0===a.sent.code&&(t.$message({type:"success",message:"删除成功!"}),1===t.tableData.length&&t.page>1&&t.page--,t.getTableData());case 4:case"end":return a.stop()}},a,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})});case 1:case"end":return a.stop()}},a,t)}))()}),enterDialog:function(){var e=this;return n()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$refs.apiForm.validate(function(){var t=n()(r.a.mark(function t(a){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=20;break}t.t0=e.type,t.next="addApi"===t.t0?4:"edit"===t.t0?11:18;break;case 4:return t.next=6,createApi(e.form);case 6:return 0===t.sent.code&&e.$message({type:"success",message:"添加成功",showClose:!0}),e.getTableData(),e.closeDialog(),t.abrupt("break",20);case 11:return t.next=13,updateApi(e.form);case 13:return 0===t.sent.code&&e.$message({type:"success",message:"编辑成功",showClose:!0}),e.getTableData(),e.closeDialog(),t.abrupt("break",20);case 18:return e.$message({type:"error",message:"未知操作",showClose:!0}),t.abrupt("break",20);case 20:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,e)}))()}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search-term"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",{attrs:{label:"路径"}},[a("el-input",{attrs:{placeholder:"路径"},model:{value:e.searchInfo.path,callback:function(t){e.$set(e.searchInfo,"path",t)},expression:"searchInfo.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{placeholder:"描述"},model:{value:e.searchInfo.description,callback:function(t){e.$set(e.searchInfo,"description",t)},expression:"searchInfo.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"api组"}},[a("el-input",{attrs:{placeholder:"api组"},model:{value:e.searchInfo.apiGroup,callback:function(t){e.$set(e.searchInfo,"apiGroup",t)},expression:"searchInfo.apiGroup"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"请求"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.searchInfo.method,callback:function(t){e.$set(e.searchInfo,"method",t)},expression:"searchInfo.method"}},e._l(e.methodOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label+"("+e.value+")",value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.onSubmit}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.openDialog("addApi")}}},[e._v("新增")]),e._v(" "),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.deleteVisible,callback:function(t){e.deleteVisible=t},expression:"deleteVisible"}},[a("p",[e._v("确定要删除吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.deleteVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onDelete}},[e._v("确定")])],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"reference",icon:"el-icon-delete",size:"mini",type:"danger"},slot:"reference"},[e._v("批量删除")])],1)],1)],1)],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,border:"",stripe:""},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"id","min-width":"60",prop:"ID",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"api路径","min-width":"150",prop:"path",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"api分组","min-width":"150",prop:"apiGroup",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"api简介","min-width":"150",prop:"description",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{label:"请求","min-width":"150",prop:"method",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n          "+e._s(t.row.method)+"\n          "),a("el-tag",{key:t.row.methodFiletr,attrs:{type:e._f("tagTypeFiletr")(t.row.method),effect:"dark",size:"mini"}},[e._v(e._s(e._f("methodFiletr")(t.row.method)))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.editApi(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(a){return e.deleteApi(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{style:{float:"right",padding:"20px"},attrs:{"current-page":e.page,"page-size":e.pageSize,"page-sizes":[10,30,50,100],total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),e._v(" "),a("el-dialog",{attrs:{"before-close":e.closeDialog,title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"apiForm",attrs:{inline:!0,model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"路径",prop:"path"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"请求",prop:"method"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}},e._l(e.methodOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label+"("+e.value+")",value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"api分组",prop:"apiGroup"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.apiGroup,callback:function(t){e.$set(e.form,"apiGroup",t)},expression:"form.apiGroup"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"api简介",prop:"description"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(s,p,!1,function(e){a("MpzO")},"data-v-2c890313",null);t.default=c.exports}});
//# sourceMappingURL=46.da322deb6c6d7a61c2ef.js.map